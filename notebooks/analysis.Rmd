---
title: "Australian RSPCA "
output: html_notebook
---

```{r}
library(here)
library(tidyverse)
```

The Data:

```{r}
townsville_complaints <- read_csv(here(
  "clean_data/townsville_complaints_clean.csv")
  )

townsville_complaints_tot_per_suburb <- read_csv(here(
  "clean_data/townsville_complaints_tot_per_suburb.csv")
  )

national_outcomes <- read_csv(here(
  "clean_data/national_outcomes_clean.csv")
  )

brisbane_complaints <- read_csv(here(
  "clean_data/brisbane_complaints_clean.csv")
  )

brisbane_complaints_tot_per_suburb <- read_csv(here(
  "clean_data/brisbane_complaints_tot_per_suburb.csv")
  )

townsville_complaints
townsville_complaints_tot_per_suburb
brisbane_complaints
brisbane_complaints_tot_per_suburb
national_outcomes
```
## Comparing complains type between Townsville and Brisbane

```{r}
townsville_complaints_tot_plot <- townsville_complaints %>% 
  ggplot() +
  geom_bar(position = "dodge", aes(x = complaint_type, fill = animal_type)) +
  labs(x = "Complaint Type", 
       y = "Totals", 
       title = "Townsville Complaint Type Totals") +
  scale_fill_manual("Animal Type", values = c("cat" = "#74c066",
                                              "dog" = "#0193cf")
                    ) +
  theme_bw() +
  theme(text=element_text(size = 16, family = "Arial"),
        axis.text.x = element_text(angle = 45, hjust = 1))
  

townsville_complaints_tot_plot
```

```{r}
exclude <- c("Dog", "Fox")

brisbane_complaints_tot_plot <- brisbane_complaints %>% 
  mutate(animal_type = str_to_lower(animal_type)) %>% 
  filter(animal_type %in% "cat" | animal_type %in% "dog") %>% 
  filter(!category %in% exclude) %>% 
  ggplot() +
  geom_bar(position = "dodge", aes(x = category, fill = animal_type)) +
  labs(x = "Complaint Type", 
       y = "Totals", 
       title = "Brisbane Complaint Type Totals") +
  scale_fill_manual("Animal Type", values = c("cat" = "#74c066",
                                              "dog" = "#0193cf")
                    ) +
  theme_bw() +
  theme(text=element_text(size = 16, family = "Arial"),
        axis.text.x = element_text(angle = 45, hjust = 1))
  

brisbane_complaints_tot_plot
```

## Brisbane vs Fox

```{r}
include <- "Fox"

brisbane_complaints_fox_plot <- brisbane_complaints %>% 
  mutate(animal_type = str_to_lower(animal_type)) %>% 
  filter(!animal_type %in% "cat" | animal_type %in% "dog") %>% 
  filter(category %in% include) %>% 
  ggplot() +
  geom_bar(position = "dodge", aes(x = category, fill = animal_type)) +
  labs(x = "Complaint Type", 
       y = "Totals", 
       title = "Brisbane Fox Troubles") +
  scale_fill_manual("Grievances", values = c("cat trapping" = "#74c066",
                                              "dog" = "#0193cf",
                                              "attack" = "#244321",
                                              "other animal" = "#d6a115")
                    ) +
  theme_bw() +
  theme(text=element_text(size = 16, family = "Arial"))
  
brisbane_complaints_fox_plot
```

```{r}
brisbane_complaints_fox_plot <- brisbane_complaints_tot_per_suburb %>% 
  mutate(animal_type = str_to_lower(animal_type)) %>% 
  filter(!animal_type %in% "cat" | animal_type %in% "dog") %>% 
  filter(category %in% include) %>% 
  filter(total > 30) %>% 
  ggplot() +
  geom_col(aes(x = suburb, y = total, fill = animal_type)) +
  labs(x = "Suburb", 
       y = "Totals", 
       title = "Brisbane Suburbs Fox Troubles*",
       caption = "* just considering Suburbs with more that 30 complaints") +
  scale_fill_manual("Grievances", values = c("cat trapping" = "#74c066",
                                              "dog" = "#0193cf",
                                              "attack" = "#244321",
                                              "other animal" = "#d6a115")
                    ) +
  theme_bw() +
  theme(text=element_text(size = 10, family = "Arial"),
        axis.text.x = element_text(angle = 90, hjust = 1),
        plot.caption = element_text(hjust = 1.4, face = "italic"))
  
brisbane_complaints_fox_plot
```

* insert map of Inala